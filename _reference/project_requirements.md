### **1. 개요**

- **문서 목적:** '아두이노 태양광 충전 키트'에서 수집되는 데이터를 시각화하여 사용자가 에너지의 생산, 저장, 소비 현황을 직관적으로 파악할 수 있는 웹/모바일 대시보드의 화면을 설계하는 것을 목적으로 한다.
- **프로젝트 목표:** 실시간 데이터 모니터링을 통해 재생 에너지의 원리를 학습하고, 시스템의 효율을 체감할 수 있는 교육적이고 흥미로운 사용자 경험을 제공한다.
- **주요 사용자:** 아두이노 프로젝트를 진행하는 학생, 메이커, 취미 개발자
- **핵심 컨셉:** **'한눈에 보는 나의 작은 발전소'** - 복잡한 숫자 나열이 아닌, 에너지의 흐름을 시각적으로 표현하여 시스템 상태를 즉시 이해할 수 있도록 한다.

---

### **2. 화면 구조 (Layout)**

대시보드는 사용자가 가장 궁금해하는 정보를 우선적으로 볼 수 있도록 3단 구조로 설계한다.

A. 실시간 에너지 흐름 (가장 상단)

---

현재 에너지의 생산 → 저장 → 소비 과정을 한눈에 보여주는

동적 다이어그램

영역

---

B. 핵심 지표 (중단)

---

가장 중요한 3가지 핵심 수치(발전량, 배터리, 소비량)를

카드 형태

로 시각화하는 영역

---

C. 이력 데이터 (하단)

---

시간의 흐름에 따른 데이터 변화를

그래프

### **와이어프레임 (Wireframe)**

```mermaid
graph TD
    subgraph Dashboard [태양광 충전 모니터링 대시보드]
        direction TB
        
        subgraph SectionA [A. 실시간 에너지 흐름 (Energy Flow)]
            direction LR
            Sun(☀️ 태양) -->|빛 에너지| Panel[태양광 패널]
            Panel -->|1.2W 충전| Battery[🔋 배터리]
            Battery -->|0.3W 방전| Load[💡 부하 (LED)]
            Panel -->|직접 구동| Load
        end
        
        subgraph SectionB [B. 핵심 지표 (Key Metrics)]
            direction LR
            Gauge(⚡️ 실시간 발전량<br/>1.2 W)
            BatStatus(�� 배터리 상태<br/>75% / 3.9V)
            Consum(🔌 현재 소비전력<br/>0.3 W)
        end
        
        subgraph SectionC [C. 이력 데이터 (History)]
            direction LR
            Chart(📊 시간대별 발전량 추이<br/>Line Chart)
            Total(📈 누적 발전/소비량<br/>Total kWh)
        end
        
        SectionA --> SectionB
        SectionB --> SectionC
    end

    style Dashboard fill:#1e1e1e,stroke:#333,color:#fff
    style SectionA fill:#2d2d2d,stroke:#444,color:#fff
    style SectionB fill:#2d2d2d,stroke:#444,color:#fff
    style SectionC fill:#2d2d2d,stroke:#444,color:#fff
    style Panel fill:#0277bd,color:#fff
    style Battery fill:#2e7d32,color:#fff
    style Load fill:#ef6c00,color:#fff
```
+----------------------------------------------------------------------+
| [C] 이력 데이터                                                        |
|                                                                      |
|  📊 시간대별 발전량 추이 (그래프)             |  📈 누적 발전/소비량 (숫자) |
|                                                                      |
+----------------------------------------------------------------------+
```

---

### **3. 위젯 상세 설계**

### **A. 실시간 에너지 흐름**

- **위젯명:** 에너지 플로우 (Energy Flow)
- **표시 정보:** 태양광 패널, 배터리, 부하(LED 등) 아이콘을 연결하여 현재 전력이 흐르는 방향과 양을 표시
- **시각화 방식:**
    - 아이콘과 아이콘 사이를 연결하는 선에 **움직이는 점(Ants Marching)** 효과를 주어 전력 흐름을 시각화한다.
    - **충전 시:** `패널 → 배터리` 방향으로 흐름 표시
    - **방전(사용) 시:** `배터리 → 부하` 방향으로 흐름 표시
    - **동시 발생 시:** `패널 → 배터리`, `패널 → 부하` 두 갈래로 흐름 표시
    - 각 연결선 위에 현재 흐르는 전력(W) 값을 작게 표시한다.
- **데이터 소스:** INA219 센서에서 측정된 패널의 발전량, 부하의 소비량 데이터를 조합하여 계산

### **B. 핵심 지표**

1. **실시간 발전량**
    - **표시 정보:** 현재 태양광 패널이 생산하는 전력(W)
    - **시각화 방식:** 반원 형태의 **게이지(Gauge)** 차트와 중앙에 큰 숫자로 현재 발전량을 표시한다. 날씨나 시간에 따라 바늘이 움직이는 것을 직관적으로 볼 수 있다.
    - **데이터 소스:** `패널 전압(V) * 패널 전류(A)`
2. **배터리 상태**
    - **표시 정보:** 배터리 잔량(%), 현재 전압(V), 충전/방전 상태
    - **시각화 방식:** 스마트폰과 유사한 **배터리 아이콘**을 사용하여 내부 색상이 잔량에 따라 채워지도록 한다. 아이콘 하단에 잔량(%)과 전압(V)을 표시하고, '충전 중', '사용 중', '완충' 같은 텍스트 상태를 추가로 보여준다.
    - **데이터 소스:** 배터리 전압을 측정하여 백분율로 변환
3. **현재 소비 전력**
    - **표시 정보:** 연결된 부하(LED, 모터 등)가 현재 소비하는 전력(W)
    - **시각화 방식:** 강조된 **숫자 카드** 형태로 간결하게 표시한다. 부하를 켜고 끌 때 숫자가 즉각적으로 변하는 것을 보여준다.
    - **데이터 소스:** `부하 전압(V) * 부하 전류(A)`

### **C. 이력 데이터**
    - **데이터 소스:** 실시간 발전량을 시간 단위로 누적 계산

### **D. 추가 확장 정보 (Advanced Info)**

사용자에게 단순 현황을 넘어선 분석, 예측, 가치 정보를 제공하기 위한 추가 화면/기능이다. 탭(Tab) 또는 모달(Modal) 형태로 제공한다.

1.  **배터리 상세 분석 (Battery Analytics)**
    - **남은 시간 예측:** 현재 소비 전력과 배터리 잔량을 기반으로 "완충까지 남은 시간" 또는 "방전까지 남은 시간"을 계산하여 표시한다. (예: "현재 사용량 지속 시 3시간 20분 후 방전")
    - **전압/전류 패턴:** 배터리 전압의 일간 변화 추이를 꺾은선 그래프로 시각화하여 배터리 건강 상태를 간접적으로 확인한다.
    - **안전 모니터링:** 배터리 온도를 모니터링하여 적정 범위(예: 10~40도)를 벗어날 경우 경고 표시.

2.  **경제 및 환경 효과 (Eco & Savings)**
    - **탄소 절감량:** 누적 발전량을 CO2 절감량(kg)으로 환산하고, 이를 이해하기 쉽게 "심은 소나무 그루 수" 아이콘으로 시각화한다. (예: 0.4kg CO2 = 소나무 0.05그루)
    - **에너지 자립률:** (소비량 대비 발전량) 비율을 계산하여 오늘의 에너지 자립률(%)을 표시한다.

3.  **시스템 진단 및 로그 (Diagnostics & Logs)**
    - **이벤트 타임라인:** 시스템의 주요 상태 변화(충전 시작/종료, 배터리 부족 경고, 과부하 감지 등)를 시간 순으로 기록하여 리스트로 보여준다.
    - **Peak 기록:** 금일 최고 발전 전력(W)과 최대 소비 전력(W) 발생 시각과 값을 기록한다.

4.  **발전 예측 및 추천 (Forecast & Insight)**
    - **발전 예보:** (외부 날씨 API 연동 시) 내일의 날씨 정보를 기반으로 예상 발전 수준(맑음/흐림/비)을 아이콘으로 안내한다.
    - **행동 가이드:** 현재 배터리 상태와 발전량을 분석하여 사용자 행동을 추천한다. (예: "발전량이 충분합니다. 보조배터리를 충전하세요.", "배터리가 부족합니다. 전등을 끄세요.")

1. **시간대별 발전량 추이**
    - **표시 정보:** 지난 24시간 동안의 시간대별 평균 발전량
    - **시각화 방식:** **선 그래프(Line Chart)** 또는 **막대 그래프(Bar Chart)**를 사용한다. X축은 시간, Y축은 발전량(W)으로 설정하여 해가 뜨고 지는 것에 따른 발전량 변화 패턴을 보여준다.
    - **데이터 소스:** 주기적으로 발전량 데이터를 저장하고, 이를 시간대별로 집계하여 표시
2. **누적 발전량**
    - **표시 정보:** 오늘 하루 동안 생산한 총 에너지의 양(Wh)
    - **시각화 방식:** "오늘 총 발전량"이라는 레이블과 함께 **숫자 카드**로 표시하여 성취감을 제공한다.
    - **데이터 소스:** 실시간 발전량을 시간 단위로 누적 계산

---

### **4. UI/UX 고려사항**

- **반응형 디자인:** PC 웹 브라우저와 모바일 화면 모두에서 최적화된 레이아웃을 제공한다.
    - **확장성:** 향후 온도, 습도, 조도 센서 등을 추가할 경우, 새로운 위젯을 쉽게 추가할 수 있는 모듈식 구조로 설계한다.

### **5. 백엔드 아키텍처 (Backend Architecture)**

데이터의 영구 저장과 이력 분석을 위해 Google Cloud Platform (GCP) 기반의 서버리스 아키텍처를 구성한다.

- **클라우드 플랫폼:** GCP (Google Cloud Platform)
- **데이터베이스:** NoSQL (Firestore 또는 Datastore)
    - **선정 이유:** 시계열 데이터의 유연한 스키마 처리와 빠른 읽기/쓰기 성능 확보
    - **데이터 모델:**
        - `devices`: 장치 메타데이터 관리
        - `measurements`: 센서 데이터 시계열 저장 (Timestamp 인덱싱)
        - `logs`: 시스템 이벤트 및 알림 로그 저장
- **API 서버:** Cloud Functions (Serverless)
    - **선정 이유:** 트래픽이 간헐적인 IoT 데이터 특성에 맞춰 비용 효율적이고 관리가 필요 없는 서버리스 방식 채택
    - **기능:**
        - 아두이노로부터 데이터 수신 (POST /api/data)
        - 프론트엔드에 데이터 제공 (GET /api/status, GET /api/history)

### **6. 보안 및 인증 (Security & Auth)**

시스템 보호를 위해 간단하지만 필수적인 인증 메커니즘을 적용한다.

- **관리자 인증:** Firebase Authentication (또는 Simple API Key)
    - 대시보드 접근 시 로그인 필요 (이메일/비밀번호 또는 구글 로그인)
    - 외부인의 무단 모니터링 및 제어 방지
- **장치 인증:** API Key 방식
    - 아두이노가 데이터 전송 시 헤더에 `X-API-Key`를 포함하여 승인된 장치만 데이터 쓰기 허용
- **색상:**
    - **발전/충전 관련:** 녹색 또는 노란색 계열
    - **소비/방전 관련:** 파란색 또는 주황색 계열
    - **경고/위험(배터리 부족 등):** 붉은색 계열
- **새로고침:** 데이터는 5~10초 간격으로 자동 업데이트되어 실시간 현황을 반영하도록 한다.
- **확장성:** 향후 온도, 습도, 조도 센서 등을 추가할 경우, 새로운 위젯을 쉽게 추가할 수 있는 모듈식 구조로 설계한다.


### 데이터 포멧
- 한글
```json
{
  "장치ID": "태양광_패널_01",
  "데이터_수신_시각": "2025-10-08T16:10:14.840374+09:00",
  "전력_계측": {
    "전압_V": 221.44,
    "전류_A": 2.34,
    "유효_전력_W": 509.73,
    "피상_전력_VA": 517.5,
    "역률": 0.985
  },
  "누적_에너지_kWh": 4.2233,
  "배터리_정보": {
    "사용_여부": true,
    "상태": "방전 중",
    "충전_상태_%": 44.54,
    "전력_흐름_W": -468.43,
    "배터리_용량_kWh": 10,
    "배터리_온도_℃": 27.53
  },
  "환경_정보": {
    "조도_Lux": 55992.84,
    "패널_온도_℃": 39.99,
    "외부_온도_℃": 26.9,
    "습도_%": 51.4
  }
}
```

```json
{
  "deviceId": "SOLAR_PANEL_01",
  "timestamp": "2025-10-08T16:13:03.326859+09:00",
  "power_metrics": {
    "voltage_v": 221.4,
    "current_a": 2.3,
    "active_power_w": 497.64,
    "apparent_power_va": 508.84,
    "power_factor": 0.978
  },
  "energy_kwh": 4.2427,
  "battery_metrics": {
    "enabled": true,
    "status": "Discharging",
    "soc_percent": 44.35,
    "power_flow_w": -475.43,
    "capacity_kwh": 10,
    "temperature_c": 27.63
  },
  "environment": {
    "illuminance_lux": 54715.35,
    "panel_temp_c": 38.22,
    "ambient_temp_c": 26.72,
    "humidity_percent": 50.21
  }
}
```